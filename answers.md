# Ответы на вопросы к практической работе №1

## 1. Команда `ip`
- IPv4 адрес: `sudo ip addr add 192.168.1.100/24 dev eth0`
- MAC адрес: `sudo ip link set dev eth0 address 00:11:22:33:44:55`
- Шлюз: `sudo ip route add default via 192.168.1.1 dev eth0`
- ARP таблица: `ip neigh show`
- Очистить ARP: `sudo ip neigh flush all`
- Включить интерфейс: `sudo ip link set dev eth0 up`
- Выключить интерфейс: `sudo ip link set dev eth0 down`

## 2. Статический адрес через `nmcli`
```bash
sudo nmcli con add type ethernet con-name static-eth0 ifname eth0 \
   ipv4.method manual ipv4.addresses 192.168.1.100/24 \
   ipv4.gateway 192.168.1.1 ipv4.dns 8.8.8.8
sudo nmcli con up static-eth0
```

## 3. Статический адрес через `netplan`
```yaml
network:
   version: 2
   renderer: networkd
   ethernets:
      eth0:
         addresses: [192.168.1.100/24]
         routes:
            - to: 0.0.0.0/0
               via: 192.168.1.1
         nameservers:
            addresses: [8.8.8.8]
```
Применение: `sudo netplan apply`.

## 4. Режимы bonding в Linux
- **balance-rr (0)** — циклическая отправка пакетов, отказоустойчивость без требований к коммутатору.
- **active-backup (1)** — один активный, один резервный, не требует поддержки снаружи.
- **balance-xor (2)** — распределение по XOR, работает с обычным коммутатором.
- **broadcast (3)** — отправка на все порты, максимум отказоустойчивости.
- **802.3ad (4)** — агрегирование по LACP, нужен коммутатор с поддержкой 802.3ad.
- **balance-tlb (5)** — адаптивная балансировка исходящего трафика, без требований к оборудованию.
- **balance-alb (6)** — адаптивная балансировка входящего и исходящего трафика, без требований к оборудованию.

## 5. Режимы duplex
- **Full duplex** — передача и приём одновременно.
- **Half duplex** — по очереди, скорость ниже.
- **Auto-negotiation** — устройства сами выбирают лучший режим.

## 6. Зачем несколько IP на одном интерфейсе
- Разделение сервисов и мониторинга.
- Плавная миграция или резервный адрес.
- Организация разных политик доступа на одном порте.

## 7. Зачем виртуальные интерфейсы
- VLAN и изоляция трафика.
- Работа виртуальных машин/контейнеров.
- Bonding, туннели и тестовые конфигурации без дополнительного железа.
   - `ifconfig` ограничен базовыми функциями настройки и мониторинга
   - `ip` поддерживает расширенные функции, включая политики маршрутизации, метки сетей, VRF и т.д.

## 10. Какие команды можно использовать для диагностики сетевых проблем в Linux?

1. **ping** - проверка соединения с удаленным хостом
   ```bash
   ping google.com
   ```

2. **traceroute/tracepath** - отображение маршрута следования пакетов
   ```bash
   traceroute google.com
   ```

3. **netstat/ss** - отображение сетевых соединений и статистики
   ```bash
   ss -tuln
   ```

4. **tcpdump** - анализ сетевого трафика
   ```bash
   sudo tcpdump -i eth0 -n host 192.168.1.1
   ```

5. **nmap** - сканирование сети и портов
   ```bash
   nmap -sS 192.168.1.1
   ```

6. **dig/nslookup** - диагностика DNS
   ```bash
   dig google.com
   ```

7. **ip/ifconfig** - просмотр и настройка сетевых интерфейсов
   ```bash
   ip addr show
   ```

8. **iperf** - тестирование пропускной способности сети
   ```bash
   iperf -c server_ip
   ```

9. **mtr** - комбинация ping и traceroute для анализа маршрута
   ```bash
   mtr google.com
   ```

10. **ethtool** - просмотр и настройка параметров сетевых интерфейсов
    ```bash
    sudo ethtool eth0
    ```

## Понятийный минимум

- **IP-адрес** — уникальный идентификатор узла в IP-сети. IPv4 состоит из 32 бит, IPv6 — из 128. Назначается статически или динамически, используется для маршрутизации пакетов.
- **Шлюз по умолчанию (Gateway)** — узел, на который отправляется трафик к адресам вне локальной сети. Настраивается через `ip route add default via <gateway>` или аналогичные инструменты.
- **DNS-адрес** — IP-адрес сервера доменных имен, который переводит доменные имена в IP-адреса. В Linux хранится в `/etc/resolv.conf` или задаётся менеджером сети.
- **DHCP-клиент** — программа, которая запрашивает у DHCP-сервера параметры сети (адрес, маску, шлюз, DNS). В Linux чаще всего используется `dhclient` (`dhclient enp0s3`).
- **DHCP-сервер** — служба, автоматически выдающая клиентам сетевые параметры. Общается по протоколу DHCP (порт UDP 67/68), хранит пул доступных адресов.
- **Режим duplex** — описывает, может ли интерфейс одновременно передавать и принимать данные: `half-duplex` — по очереди, `full-duplex` — одновременно. Настройки и текущее состояние смотри через `ethtool enp0s3`.
- **Имя интерфейса в Linux** — системное обозначение сетевой карты (`enp0s3`, `eth0`, `ens33`). Имена predictable, зависят от шины/порта. Список интерфейсов: `ip link show`.
- **ifconfig** — устаревшая утилита, но всё ещё используется для быстрых сводок (`ifconfig -a`). Показывает IP, MAC, состояние интерфейсов.
- **ip** — современный инструмент из `iproute2`. Основные контексты: `ip addr` (адреса), `ip link` (состояние), `ip route` (маршруты). Позволяет добавлять/удалять адреса и маршруты.
- **dhclient** — DHCP-клиент. Команда `sudo dhclient -r enp0s3` освобождает арендованный адрес, `sudo dhclient enp0s3` запрашивает новый.
- **/etc/resolv.conf** — конфигурационный файл резолвера. Строки `nameserver <IP>` определяют DNS-серверы. Может управляться NetworkManager или systemd-resolved, поэтому изменения вручную иногда перезаписываются.
- **nmcli** — CLI к NetworkManager. Позволяет включать/выключать интерфейсы (`nmcli device up/down`), создавать профили с статическими/динамическими адресами (`nmcli con add ...`, `nmcli con mod ...`).
- **Netplan** — декларативный способ конфигурации сети на Ubuntu/Debian. YAML-файлы в `/etc/netplan/`, далее `sudo netplan apply`. Поддерживает ручные адреса (`addresses:`) и DHCP (`dhcp4: true`).
- **Bonding** — объединение нескольких физ. интерфейсов в один логический для отказоустойчивости/балансировки. Настройки читаются из `/proc/net/bonding/<имя>`; основные режимы — `balance-rr`, `active-backup`, `802.3ad` и др.
- **Статистика интерфейсов** — в `/proc/net/dev` доступны счётчики RX/TX байтов и пакетов для каждого интерфейса. Удобно использовать для мониторинга и скриптов (`grep enp0s3 /proc/net/dev`).